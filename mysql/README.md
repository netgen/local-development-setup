# Set up `MySQL` database server

`MySQL` is an open-source relational database management system.

## 1 Install

### 1.1 If using MacOS with MacPorts

Execute on the command line:

```console
sudo port install mysql8-server
```

Select `mysql8` as your preferred version of `MySQL` with:

```console
sudo port select mysql mysql8
```

### 1.2 If using MacOS with Homebrew

Execute on the command line:

```console
brew install mysql
```

## 2 Start

Since `MySQL` is an essential part of our web apps, so we want it always running
and started automatically after a reboot.

### 2.1 If using MacOS with MacPorts

First initialize the server by executing on the command line:

```console
sudo /opt/local/lib/mysql8/bin/mysqld --initialize --user=_mysql
```

Take note of the `root` password generated by the command as you will need it in
the next step.

Now you can start the server with:

```console
sudo port load mysql8-server
```

This will also start the server automatically after a reboot.

To stop the server and prevent it from running after a reboot, execute:

```console
sudo port unload mysql8-server
```

### 2.1 If using MacOS with Homebrew

Execute on the command line:

```console
brew services start mysql
```

This will also start the server automatically after a reboot.

To stop the server and prevent it from running after a reboot, execute:

```console
brew services stop mysql
```

## 3 Secure

Improve the security of the installation by executing the following on the
command line:

```console
mysql_secure_installation
```

Follow the instructions to configure `root` as password for the `root` user. If
`MySQL` was installed using MacPorts, enter the password generated at the
initialization.

Additionally, follow the instructions to skip setting up VALIDATE PASSWORD
component, remove anonymous users and test databases and disallow the remote
login for `root`. That will be sufficient for local development needs.

## 4 Configure

**Note**: this step is necessary only you are using MacOS with MacPorts.

Edit file `/opt/local/etc/mysql8/my.cnf`, remove or comment out the line
including the default MacPorts settings and add the following configuration.

```dosini
[mysqld]
basedir="/opt/local"
bind-address=127.0.0.1
```

Now reload the server with:

```console
sudo port reload mysql8-server
```

## 4 Test

Log into the server by executing the following on the command line:

```console
mysql -uroot -p
```

Enter the password `root` when asked. If you set up everything correctly, you
should arrive at the MySQL command-line client:

```text
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 49

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql>
```

Do not exit the client as you will need it in the next step.

## 5 Configure again

`MySQL` will create binary log files that take up valuable disk space, but are
not really needed for local development. Set binary logs to expire after one day
by executing on the `mysql` prompt:

```console
SET GLOBAL binlog_expire_logs_seconds=86400;
SET PERSIST binlog_expire_logs_seconds=86400;
```

You can now type `exit` to exit the MySQL command-line client.

## 6 Install a GUI client

You will probably want a graphical UI client to work with the database server.
For MacOS, [TablePlus](https://tableplus.com/) is a good choice, offering
unlimited free trial with reasonable limitations for light use.

Install your preferred GUI client and configure the connection to the server. If
the connection works, you've finished installing and configuring your `MySQL`
server.
